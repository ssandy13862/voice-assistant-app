# æ™ºæ…§èªéŸ³åŠ©ç† Android æ‡‰ç”¨

## å°ˆæ¡ˆæ¦‚è¿°

é€™æ˜¯ä¸€å€‹åŸºæ–¼ Android å¹³å°çš„æ™ºæ…§èªéŸ³åŠ©ç†æ‡‰ç”¨ï¼Œæ•´åˆäº†äººè‡‰è­˜åˆ¥ã€èªéŸ³æ´»å‹•æª¢æ¸¬(VAD)ã€èªéŸ³è­˜åˆ¥(STT)ã€AIå°è©±å’ŒèªéŸ³åˆæˆ(TTS)åŠŸèƒ½ï¼Œå¯¦ç¾è‡ªç„¶çš„äººæ©Ÿäº’å‹•é«”é©—ã€‚

## åŠŸèƒ½ç‰¹æ€§

### ğŸ¯ æ ¸å¿ƒåŠŸèƒ½

1. **äººè‡‰è­˜åˆ¥è§¸ç™¼**
   - ä½¿ç”¨ Google ML Kit Face Detection é€²è¡Œå³æ™‚äººè‡‰æª¢æ¸¬
   - æª¢æ¸¬åˆ°äººè‡‰æ™‚è‡ªå‹•å•Ÿå‹•èªéŸ³æ”¶éŸ³åŠŸèƒ½
   - æ”¯æ´å¤šäººè‡‰å ´æ™¯ï¼Œè‡ªå‹•é¸æ“‡æœ€å¤§äººè‡‰
   - äººè‡‰é›¢é–‹æ™‚è‡ªå‹•åœæ­¢æ”¶éŸ³

2. **èªéŸ³æ´»å‹•æª¢æ¸¬ (VAD)**
   - åŸºæ–¼éŸ³é »èƒ½é‡çš„å³æ™‚èªéŸ³æ´»å‹•æª¢æ¸¬
   - è‡ªå‹•è­˜åˆ¥ä½¿ç”¨è€…é–‹å§‹/çµæŸèªªè©±
   - é¿å…éŒ„è£½ç„¡è²ç‰‡æ®µï¼Œæå‡è­˜åˆ¥æ•ˆç‡
   - å¯èª¿ç¯€æª¢æ¸¬éˆæ•åº¦

3. **èªéŸ³è­˜åˆ¥ (STT)**
   - æ•´åˆ Whisper API é€²è¡ŒèªéŸ³è½‰æ–‡å­—
   - æ”¯æ´ä¸­æ–‡å’Œè‹±æ–‡èªéŸ³è­˜åˆ¥
   - é«˜ç²¾åº¦èªéŸ³è­˜åˆ¥èƒ½åŠ›

4. **AI å°è©±è™•ç†**
   - æ•´åˆ OpenAI GPT API ä½œç‚ºå°è©±å¤§è…¦
   - æ”¯æ´è‡ªç„¶å°è©±åŠŸèƒ½ï¼ˆå•ç­”ã€é–’èŠç­‰ï¼‰
   - ä¿æŒå°è©±ä¸Šä¸‹æ–‡å’Œæ­·å²è¨˜éŒ„
   - æ™ºæ…§å›æ‡‰ç”Ÿæˆ

5. **èªéŸ³åˆæˆ (TTS)**
   - ä½¿ç”¨ Android ç³»çµ±å…§å»º TTS API
   - æ”¯æ´ä¸­æ–‡å’Œè‹±æ–‡èªéŸ³åˆæˆ
   - è‡ªç„¶æµæš¢çš„èªéŸ³è¼¸å‡º
   - å¯èª¿ç¯€èªé€Ÿå’ŒéŸ³èª¿

6. **è‡ªç”±éº¥å…‹é¢¨æ¨¡å¼**
   - æ‰‹å‹•é–‹é—œæŒçºŒå°è©±æ¨¡å¼
   - VAD æŒçºŒé‹ä½œï¼Œè‡ªå‹•åˆ¤æ–·èªªè©±æ®µè½
   - æ”¯æ´é€£çºŒå°è©±é«”é©—

7. **æ’è©±æ‰“æ–·æ©Ÿåˆ¶**
   - AI èªªè©±æ™‚æ”¯æ´ä½¿ç”¨è€…éš¨æ™‚æ’è©±
   - æª¢æ¸¬åˆ°ä½¿ç”¨è€…èªéŸ³ç«‹å³åœæ­¢ TTS æ’­æ”¾
   - å¿«é€Ÿåˆ‡æ›åˆ°è†è½æ¨¡å¼
   - ä¿æŒå°è©±ä¸Šä¸‹æ–‡é€£è²«æ€§

## æŠ€è¡“æ¶æ§‹

### ğŸ—ï¸ æ¶æ§‹è¨­è¨ˆ

```
â”œâ”€â”€ Presentation Layer (UI)
â”‚   â”œâ”€â”€ Activities
â”‚   â”œâ”€â”€ ViewModels (MVVM)
â”‚   â””â”€â”€ Adapters
â”‚
â”œâ”€â”€ Domain Layer (Business Logic)
â”‚   â”œâ”€â”€ UseCases
â”‚   â”œâ”€â”€ Models
â”‚   â””â”€â”€ Repository Interfaces
â”‚
â””â”€â”€ Data Layer
    â”œâ”€â”€ Repository Implementations
    â”œâ”€â”€ API Services
    â””â”€â”€ Local Storage
```

### ğŸ› ï¸ æŠ€è¡“å †ç–Š

- **æ¶æ§‹æ¨¡å¼**: Clean Architecture + MVVM
- **é–‹ç™¼èªè¨€**: Kotlin
- **ä¾è³´æ³¨å…¥**: Dagger Hilt
- **UIæ¡†æ¶**: Material Design Components + Data Binding
- **ç›¸æ©Ÿè™•ç†**: CameraX
- **äººè‡‰è­˜åˆ¥**: Google ML Kit Face Detection
- **ç¶²è·¯è«‹æ±‚**: Retrofit + OkHttp
- **éåŒæ­¥è™•ç†**: Kotlin Coroutines + Flow
- **èªéŸ³åˆæˆ**: Android TextToSpeech API

### ğŸ“‹ å¿…è¦æ•´åˆ

- **äººè‡‰è­˜åˆ¥**: Google ML Kit Face Detection
- **AIå¤§è…¦**: OpenAI API (GPT-3.5/GPT-4)
- **VAD**: åŸºæ–¼éŸ³é »èƒ½é‡çš„ç°¡åŒ–VADæ¼”ç®—æ³•
- **STT**: Whisper API (è‡ªæ¶ç‰ˆæœ¬)
- **TTS**: Android ç³»çµ±å…§å»º TTS API

## å®‰è£å’Œé…ç½®

### ğŸ”§ ç’°å¢ƒéœ€æ±‚

- Android Studio Arctic Fox (2020.3.1) æˆ–æ›´é«˜ç‰ˆæœ¬
- Android SDK API Level 24 (Android 7.0) æˆ–æ›´é«˜
- Kotlin 1.9.10
- Gradle 8.0

### ğŸ“¦ ä¾è³´å®‰è£

1. **è¤‡è£½å°ˆæ¡ˆ**
   ```bash
   git clone https://github.com/your-repo/voice-assistant-android.git
   cd voice-assistant-android
   ```

2. **é…ç½® API Keys**
   
   åœ¨ `app/src/main/java/com/voiceassistant/app/data/repository/SpeechRepositoryImpl.kt` ä¸­é…ç½®ï¼š
   ```kotlin
   private val openAiApiKey = "your_openai_api_key_here"
   ```

3. **é…ç½® Whisper æœå‹™**
   
   åœ¨ `app/src/main/java/com/voiceassistant/app/di/NetworkModule.kt` ä¸­ä¿®æ”¹ï¼š
   ```kotlin
   .baseUrl("http://your-whisper-server.com/")
   ```

4. **åŒæ­¥å°ˆæ¡ˆ**
   ```bash
   ./gradlew clean
   ./gradlew build
   ```

### ğŸš€ é‹è¡Œæ‡‰ç”¨

1. é€£æ¥ Android è£ç½®æˆ–å•Ÿå‹•æ¨¡æ“¬å™¨
2. åœ¨ Android Studio ä¸­é»æ“Š "Run" æŒ‰éˆ•
3. æˆäºˆæ‡‰ç”¨ç›¸æ©Ÿå’Œéº¥å…‹é¢¨æ¬Šé™
4. é–‹å§‹ä½¿ç”¨èªéŸ³åŠ©ç†åŠŸèƒ½

## ä½¿ç”¨èªªæ˜

### ğŸ“± ä»‹é¢æ“ä½œ

1. **å•Ÿå‹•æ‡‰ç”¨**
   - æ‡‰ç”¨å•Ÿå‹•å¾Œæœƒè«‹æ±‚ç›¸æ©Ÿå’Œéº¥å…‹é¢¨æ¬Šé™
   - æˆæ¬Šå¾Œç›¸æ©Ÿé è¦½ä»‹é¢æœƒè‡ªå‹•é¡¯ç¤º

2. **äººè‡‰è§¸ç™¼æ¨¡å¼**
   - é¢å‘å‰ç½®æ”å½±æ©Ÿï¼Œæ‡‰ç”¨æœƒè‡ªå‹•æª¢æ¸¬äººè‡‰
   - æª¢æ¸¬åˆ°äººè‡‰å¾Œç‹€æ…‹æŒ‡ç¤ºå™¨è®Šç‚ºè—è‰²"æª¢æ¸¬ä¸­"
   - é–‹å§‹èªªè©±æ™‚æœƒè‡ªå‹•é€²å…¥"è†è½ä¸­"ç‹€æ…‹

3. **è‡ªç”±æ¨¡å¼**
   - é»æ“Š"è‡ªç”±æ¨¡å¼"æŒ‰éˆ•é€²å…¥æŒçºŒå°è©±æ¨¡å¼
   - åœ¨æ­¤æ¨¡å¼ä¸‹ç„¡éœ€äººè‡‰è§¸ç™¼å³å¯é€²è¡Œå°è©±
   - å†æ¬¡é»æ“Šå¯é€€å‡ºè‡ªç”±æ¨¡å¼

4. **æ’è©±åŠŸèƒ½**
   - ç•¶AIæ­£åœ¨èªªè©±æ™‚ï¼ˆç´«è‰²"èªªè©±ä¸­"ç‹€æ…‹ï¼‰
   - ç›´æ¥é–‹å§‹èªªè©±æˆ–é»æ“Š"æ‰“æ–·"æŒ‰éˆ•å¯ä¸­æ–·AI
   - ç«‹å³åˆ‡æ›åˆ°è†è½æ¨¡å¼

5. **å°è©±æ­·å²**
   - æ‰€æœ‰å°è©±è¨˜éŒ„æœƒé¡¯ç¤ºåœ¨ä»‹é¢ä¸‹æ–¹
   - é»æ“Š"æ¸…é™¤æ­·å²"å¯æ¸…ç©ºå°è©±è¨˜éŒ„

### ğŸ›ï¸ ç‹€æ…‹æŒ‡ç¤º

- **ç°è‰² - å¾…æ©Ÿä¸­**: æ‡‰ç”¨é–’ç½®ç‹€æ…‹
- **è—è‰² - æª¢æ¸¬ä¸­**: æ­£åœ¨æª¢æ¸¬äººè‡‰
- **ç¶ è‰² - è†è½ä¸­**: æ­£åœ¨è†è½ä½¿ç”¨è€…èªéŸ³
- **æ©™è‰² - è™•ç†ä¸­**: æ­£åœ¨é€²è¡ŒèªéŸ³è­˜åˆ¥å’ŒAIè™•ç†
- **ç´«è‰² - èªªè©±ä¸­**: AIæ­£åœ¨é€²è¡ŒèªéŸ³å›æ‡‰
- **ç´…è‰² - éŒ¯èª¤ç‹€æ…‹**: ç™¼ç”ŸéŒ¯èª¤

## æ•ˆèƒ½åˆ†æ

### âš¡ å»¶é²åˆ†æ

| æ¨¡çµ„ | å¹³å‡å»¶é² | èªªæ˜ |
|------|----------|------|
| äººè‡‰æª¢æ¸¬ | 50-100ms | å³æ™‚æª¢æ¸¬ï¼Œå»¶é²è¼ƒä½ |
| VADæª¢æ¸¬ | 10-30ms | åŸºæ–¼éŸ³é »èƒ½é‡ï¼Œå›æ‡‰å¿«é€Ÿ |
| èªéŸ³è­˜åˆ¥ | 1-3ç§’ | å–æ±ºæ–¼ç¶²è·¯å’ŒèªéŸ³é•·åº¦ |
| AIå°è©± | 1-5ç§’ | å–æ±ºæ–¼ç¶²è·¯å’ŒOpenAIå›æ‡‰æ™‚é–“ |
| èªéŸ³åˆæˆ | 500ms-2ç§’ | ç³»çµ±TTSï¼Œå»¶é²é©ä¸­ |

### ğŸ”‹ è³‡æºä½¿ç”¨

- **CPUä½¿ç”¨ç‡**: 15-25% (äººè‡‰æª¢æ¸¬å’ŒéŸ³é »è™•ç†)
- **è¨˜æ†¶é«”ä½”ç”¨**: 80-120MB
- **é›»æ± æ¶ˆè€—**: ä¸­ç­‰ (ä¸»è¦ä¾†è‡ªç›¸æ©Ÿå’ŒæŒçºŒéŸ³é »æª¢æ¸¬)
- **ç¶²è·¯æµé‡**: å–æ±ºæ–¼å°è©±é »ç‡å’Œé•·åº¦

## å·²çŸ¥é™åˆ¶å’Œæ”¹é€²æ–¹å‘

### âš ï¸ ç›®å‰é™åˆ¶

1. **VADæ¼”ç®—æ³•ç°¡åŒ–**
   - ç›®å‰ä½¿ç”¨åŸºæ–¼éŸ³é »èƒ½é‡çš„ç°¡åŒ–VAD
   - å»ºè­°æ•´åˆæ›´å…ˆé€²çš„Silero VADæˆ–é¡ä¼¼é–‹æºæ–¹æ¡ˆ

2. **éŸ³é »éŒ„è£½åŠŸèƒ½**
   - ç›®å‰ç‚ºæ¦‚å¿µå¯¦ä½œï¼Œç¼ºå°‘å®Œæ•´çš„éŸ³é »éŒ„è£½å’Œå¿«å–
   - éœ€è¦æ–°å¢éŸ³é »æª”æ¡ˆç®¡ç†å’Œæš«å­˜å„²å­˜

3. **é›¢ç·šåŠŸèƒ½**
   - ä¾è³´ç¶²è·¯é€£ç·šé€²è¡ŒSTTå’ŒAIå°è©±
   - å¯è€ƒæ…®æ•´åˆæœ¬åœ°èªéŸ³è­˜åˆ¥å’Œé›¢ç·šAIæ¨¡å‹

4. **å¤šèªè¨€æ”¯æ´**
   - ç›®å‰ä¸»è¦æ”¯æ´ä¸­æ–‡ï¼Œè‹±æ–‡æ”¯æ´æœ‰é™
   - å¯æ“´å±•å¤šèªè¨€è‡ªå‹•æª¢æ¸¬å’Œåˆ‡æ›

### ğŸš€ æœªä¾†æ”¹é€²

1. **æ›´å¼·å¤§çš„VAD**
   - æ•´åˆSilero VADæˆ–WebRTCVAD
   - æ”¯æ´å™ªéŸ³ç’°å¢ƒä¸‹çš„èªéŸ³æª¢æ¸¬

2. **éŸ³é »å„ªåŒ–**
   - æ–°å¢éŸ³é »é™å™ªè™•ç†
   - å¯¦ç¾éŸ³é »ä¸²æµè™•ç†å’Œå¿«å–å„ªåŒ–

3. **é›¢ç·šæ¨¡å¼**
   - æ•´åˆæœ¬åœ°STTæ¨¡å‹(å¦‚Vosk)
   - æœ¬åœ°AIå°è©±æ¨¡å‹æ•´åˆ

4. **å€‹äººåŒ–åŠŸèƒ½**
   - ä½¿ç”¨è€…åå¥½å­¸ç¿’å’Œè¨˜æ†¶
   - è‡ªè¨‚å–šé†’è©æ”¯æ´
   - è²ç´‹è­˜åˆ¥å’Œå€‹äººåŒ–å›æ‡‰

5. **æ“´å……åŠŸèƒ½**
   - æƒ…ç·’è­˜åˆ¥å’Œæƒ…æ„Ÿå›æ‡‰
   - æ‰‹å‹¢è­˜åˆ¥æ•´åˆ
   - å¤šæ¨¡æ…‹äº’å‹•æ”¯æ´

## æŠ€è¡“æ–‡ä»¶

### ğŸ”„ ç‹€æ…‹æ©Ÿè¨­è¨ˆ

```mermaid
stateDiagram-v2
    [*] --> IDLE
    IDLE --> DETECTING : æª¢æ¸¬åˆ°äººè‡‰
    DETECTING --> LISTENING : äººè‡‰ç¢ºèª
    LISTENING --> PROCESSING : æª¢æ¸¬åˆ°èªéŸ³
    PROCESSING --> SPEAKING : AIå›æ‡‰ç”Ÿæˆ
    SPEAKING --> LISTENING : TTSå®Œæˆ
    SPEAKING --> LISTENING : ä½¿ç”¨è€…æ‰“æ–·
    LISTENING --> IDLE : äººè‡‰æ¶ˆå¤±
    DETECTING --> IDLE : äººè‡‰æ¶ˆå¤±
    * --> ERROR : éŒ¯èª¤ç™¼ç”Ÿ
    ERROR --> IDLE : éŒ¯èª¤æ¢å¾©
```

### ğŸŒŠ éŸ³é »è™•ç†æµç¨‹

```
éŸ³é »è¼¸å…¥ â†’ VADæª¢æ¸¬ â†’ èªéŸ³ç‰‡æ®µ â†’ STTè™•ç† â†’ æ–‡å­—è¼¸å‡º
    â†“           â†“         â†“         â†“         â†“
  éº¥å…‹é¢¨      èƒ½é‡åˆ†æ    å¿«å–éŒ„éŸ³   APIèª¿ç”¨   ä½¿ç”¨è€…è¼¸å…¥
```

### ğŸ”— APIæ•´åˆæ–¹å¼

1. **OpenAI APIæ•´åˆ**
   ```kotlin
   // é…ç½®APIå®¢æˆ¶ç«¯
   @POST("chat/completions")
   suspend fun createChatCompletion(
       @Header("Authorization") authorization: String,
       @Body request: ChatCompletionRequest
   ): Response<ChatCompletionResponse>
   ```

2. **Whisper APIæ•´åˆ**
   ```kotlin
   // èªéŸ³æª”æ¡ˆä¸Šå‚³å’Œè½‰éŒ„
   @Multipart
   @POST("transcribe")
   suspend fun transcribeAudio(
       @Part("file") audioFile: File,
       @Part("model") model: String = "whisper-1"
   ): Response<TranscriptionResponse>
   ```

### ğŸ” æ¬Šé™ç®¡ç†

æ‡‰ç”¨éœ€è¦ä»¥ä¸‹æ¬Šé™ï¼š
- `CAMERA`: äººè‡‰æª¢æ¸¬å’Œç›¸æ©Ÿé è¦½
- `RECORD_AUDIO`: èªéŸ³è¼¸å…¥å’ŒVADæª¢æ¸¬
- `INTERNET`: APIèª¿ç”¨å’Œè³‡æ–™å‚³è¼¸
- `ACCESS_NETWORK_STATE`: ç¶²è·¯ç‹€æ…‹æª¢æŸ¥

### ğŸ”’ éš±ç§ä¿è­·

1. **è³‡æ–™è™•ç†**
   - éŸ³é »è³‡æ–™åƒ…ç”¨æ–¼å³æ™‚è™•ç†ï¼Œä¸é€²è¡Œæœ¬åœ°å„²å­˜
   - å°è©±æ­·å²å„²å­˜åœ¨æœ¬åœ°ï¼Œä¸ä¸Šå‚³åˆ°é›²ç«¯
   - äººè‡‰æª¢æ¸¬åƒ…ç”¨æ–¼è§¸ç™¼ï¼Œä¸å„²å­˜äººè‡‰å½±åƒ

2. **APIå®‰å…¨**
   - OpenAI API Keyéœ€è¦å®‰å…¨å„²å­˜
   - å»ºè­°ä½¿ç”¨åŠ å¯†å„²å­˜æˆ–ç’°å¢ƒè®Šæ•¸
   - ç¶²è·¯å‚³è¼¸ä½¿ç”¨HTTPSåŠ å¯†

## è²¢ç»æŒ‡å—

### ğŸ¤ åƒèˆ‡é–‹ç™¼

1. Fork å°ˆæ¡ˆå„²å­˜åº«
2. å»ºç«‹åŠŸèƒ½åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤è®Šæ›´ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. å»ºç«‹ Pull Request

### ğŸ“ ç¨‹å¼ç¢¼è¦ç¯„

- éµå¾ª Kotlin å®˜æ–¹ç·¨ç¢¼è¦ç¯„
- ä½¿ç”¨æœ‰æ„ç¾©çš„å‘½åå’Œè¨»è§£
- ä¿æŒç¨‹å¼ç¢¼ç°¡æ½”å’Œå¯è®€æ€§
- æ–°å¢é©ç•¶çš„å–®å…ƒæ¸¬è©¦

## æˆæ¬Šæ¢æ¬¾

æœ¬å°ˆæ¡ˆæ¡ç”¨ MIT æˆæ¬Šæ¢æ¬¾ - æŸ¥çœ‹ [LICENSE](LICENSE) æª”æ¡ˆäº†è§£è©³æƒ…ã€‚

## è¯çµ¡æ–¹å¼

å¦‚æœ‰å•é¡Œæˆ–å»ºè­°ï¼Œè«‹é€éä»¥ä¸‹æ–¹å¼è¯çµ¡ï¼š

- å°ˆæ¡ˆIssues: [GitHub Issues](https://github.com/your-repo/voice-assistant-android/issues)
- é›»å­éƒµä»¶: your-email@example.com

## è‡´è¬

æ„Ÿè¬ä»¥ä¸‹é–‹æºå°ˆæ¡ˆå’Œæœå‹™ï¼š

- [Google ML Kit](https://developers.google.com/ml-kit) - äººè‡‰æª¢æ¸¬
- [OpenAI API](https://openai.com/api/) - AIå°è©±è™•ç†
- [Android CameraX](https://developer.android.com/training/camerax) - ç›¸æ©Ÿè™•ç†
- [Material Design](https://material.io/) - UIè¨­è¨ˆè¦ç¯„
- [Dagger Hilt](https://dagger.dev/hilt/) - ä¾è³´æ³¨å…¥

---

**æ³¨æ„**: é€™æ˜¯ä¸€å€‹é¢è©¦ä½œæ¥­å°ˆæ¡ˆï¼Œé‡é»å±•ç¤ºæ¶æ§‹è¨­è¨ˆå’ŒæŠ€è¡“æ•´åˆèƒ½åŠ›ã€‚éƒ¨åˆ†åŠŸèƒ½ç‚ºæ¦‚å¿µå¯¦ä½œï¼Œå¯¦éš›ç”Ÿç”¢ç’°å¢ƒä½¿ç”¨éœ€è¦é€²ä¸€æ­¥å®Œå–„å’Œå„ªåŒ–ã€‚
